<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ­Ù„ÛŒÙ„Ú¯Ø± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙÛŒÙˆÚ†Ø±Ø² Ú©Ø±ÛŒÙ¾ØªÙˆ - ÙˆØ±ÙˆØ¯ÛŒ Ù…ØªÙ†ÛŒ</title>
    <style>
        body {
            font-family: Tahoma, sans-serif;
            background-color: #1e1e2f;
            color: #e0e0e0;
            padding: 10px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #2a2a47;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        h1, h2 {
            color: #61dafb;
            text-align: center;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .input-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #4a4a6b;
            border-radius: 5px;
            background-color: #3b3b5b;
            color: #e0e0e0;
            box-sizing: border-box;
            min-height: 100px;
            font-family: monospace;
            font-size: 0.9em;
        }
        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        button {
            flex-grow: 1;
            padding: 10px;
            background-color: #61dafb;
            color: #1e1e2f;
            border: none;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button.clear-btn {
            background-color: #f44336;
            color: #e0e0e0;
        }
        button.clear-btn:hover {
            background-color: #cc332a;
        }
        button:hover {
            background-color: #4db4d6;
        }
        #analysis-output {
            margin-top: 30px;
            padding: 15px;
            border-top: 2px solid #61dafb;
            background-color: #1e1e2f;
            border-radius: 5px;
        }
        #analysis-output h3 {
            color: #4db4d6;
            margin-top: 0;
            text-align: right;
        }
        .sentiment-bullish { color: #4CAF50; }
        .sentiment-bearish { color: #F44336; }
        .sentiment-neutral { color: #FFEB3B; }
        .error { color: #F44336; font-weight: bold; }

        /* --- Ø³Ø¨Ú©â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ Ø¨Ù‡ÛŒÙ†Ù‡ Ø¨Ø±Ø§ÛŒ Ø¬Ø¯Ø§ÙˆÙ„ ØªØ®ØµØµÛŒ --- */
        .table-section {
            margin-bottom: 20px;
            border: 1px solid #3b3b5b;
            border-radius: 5px;
            padding: 10px;
        }
        .table-section h3 {
            color: #e0e0e0;
            border-bottom: 1px dashed #4a4a6b;
            padding-bottom: 5px;
            margin-top: 0;
            text-align: right;
            font-size: 1.1em;
        }
        /* Ø¬Ø¯ÙˆÙ„ Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ Ø¨Ø±Ø§ÛŒ Ø¬Ø¯Ø§ÙˆÙ„ Ú©ÙˆÚ†Ú© */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            direction: ltr;
            font-size: 0.9em;
        }
        .data-table th, .data-table td {
            border: 1px solid #4a4a6b;
            padding: 8px;
            text-align: center;
            white-space: nowrap;
        }
        .data-table th {
            background-color: #3b3b5b;
            color: #61dafb;
        }
        .data-table tr:nth-child(even) {
            background-color: #3b3b5b;
        }
        /* Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ø¯Ø¯ÛŒ Ù…Ù‡Ù… */
        .data-table td.green { color: #4CAF50; }
        .data-table td.red { color: #F44336; }
        .data-table td.yellow { color: #FFEB3B; }
        .data-table td.blue { color: #61dafb; }
        .data-placeholder { color: #aaa; } /* Ø³Ø¨Ú© Ø¨Ø±Ø§ÛŒ Ù…Ø­ØªÙˆØ§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ */
    </style>
</head>
<body>

<div class="container">
    <h1>ØªØ­Ù„ÛŒÙ„Ú¯Ø± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙÛŒÙˆÚ†Ø±Ø² Ú©Ø±ÛŒÙ¾ØªÙˆ</h1>
    <p style="text-align: center; color: #aaa;">
        **Ø±Ø§Ù‡Ù†Ù…Ø§:** Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø§Ø² **Ù†Ù…Ø§Ø¯ Ú©ÙˆÛŒÙ†** ØªØ§ Ø¢Ø®Ø±ÛŒÙ† Ø³ØªÙˆÙ† (Ø¬Ù…Ø¹Ø§Ù‹ **Û²Û¶ Ø³ØªÙˆÙ†**) Ú©Ù¾ÛŒ Ùˆ Ø¬Ø§ÛŒâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯.
    </p>

    <div class="input-group">
        <label for="rawData">ÙˆØ±ÙˆØ¯ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ (Ù‡Ø± Ø³ØªÙˆÙ† Ø±Ø§ Ø¨Ø§ ØªØ¨ ÛŒØ§ Ú†Ù†Ø¯ ÙØ§ØµÙ„Ù‡ Ø¬Ø¯Ø§ Ú©Ù†ÛŒØ¯):</label>
        <textarea id="rawData" placeholder="
Symbol Price price 24% fundingRate 
Volume 24 volume 24% mc
oi oi1h % oi24h%
liquidity 24
rsi
oi/24h_vol
oi/24h_vol%
long liquid 24
short liquid 24
long/short 24
l/s accounts
top trader l/s accounts
top trader l/s position"></textarea>
    </div>

    <div class="button-group">
        <button onclick="analyzeData()">ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§</button>
        <button class="clear-btn" onclick="clearForm()">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙØ±Ù…</button>
    </div>

    <div id="data-display-section" style="display: none;">
        <h2>ğŸ“Š Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ø¯Ù‡ (ØªÙÚ©ÛŒÚ© Ø´Ø¯Ù‡)</h2>

        <div class="table-section">
            <h3>ğŸ“ˆ Ù‚ÛŒÙ…ØªØŒ ØªØºÛŒÛŒØ±Ø§Øª Ùˆ RSI</h3>
            <table class="data-table">
                <thead>
                    <tr><th>Ù¾Ø§Ø±Ø§Ù…ØªØ±</th><th>Ù…Ù‚Ø¯Ø§Ø±</th></tr>
                </thead>
                <tbody id="price-table-body"></tbody>
            </table>
        </div>

        <div class="table-section">
            <h3>ğŸ’°Funding Rate ,Open Interest </h3>
            <table class="data-table">
                <thead>
                    <tr><th>Ù¾Ø§Ø±Ø§Ù…ØªØ±</th><th>Ù…Ù‚Ø¯Ø§Ø±</th></tr>
                </thead
                ><tbody id="oi-table-body"></tbody>
            </table>
        </div>

        <div class="table-section">
            <h3>ğŸ”¥ Ù„ÛŒÚ©ÙˆØ¦ÛŒØ¯ÛŒØ´Ù†â€ŒÙ‡Ø§ Ùˆ Ù¾ÙˆØ²ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²</h3>
            <table class="data-table">
                <thead>
                    <tr><th>Ù¾Ø§Ø±Ø§Ù…ØªØ±</th><th>Ù…Ù‚Ø¯Ø§Ø±</th></tr>
                </thead>
                <tbody id="liquidation-table-body"></tbody>
            </table>
        </div>

        <div class="table-section">
            <h3>âš–ï¸ Ù†Ø³Ø¨Øª Ù„Ø§Ù†Ú¯/Ø´ÙˆØ±Øª (Long/Short Ratios)</h3>
            <table class="data-table">
                <thead>
                    <tr><th>Ù¾Ø§Ø±Ø§Ù…ØªØ±</th><th>Ù…Ù‚Ø¯Ø§Ø±</th></tr>
                </thead>
                <tbody id="ratio-table-body"></tbody>
            </table>
        </div>
    </div>
    
    <div id="analysis-output">
        <h3>Ø®Ù„Ø§ØµÙ‡ ØªØ­Ù„ÛŒÙ„</h3>
        <p class="error" id="error-message" style="display: none;">Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§. Ù„Ø·ÙØ§ Ù…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ **Û²Û¶ Ø³ØªÙˆÙ†** Ø±Ø§ Ø§Ø² **Ù†Ù…Ø§Ø¯ Ú©ÙˆÛŒÙ†** (Symbol) Ø¨Ù‡ Ø¨Ø¹Ø¯ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯. (ØªØ¹Ø¯Ø§Ø¯ Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ: <span id="col-count">0</span>)</p>
        <p id="output-oi"></p>
        <p id="output-open-positions"></p>
        <p id="output-liquidation"></p>
        <p id="output-funding"></p>
        <p id="output-rsi"></p>
        <p id="output-conclusion"></p>
    </div>
</div>

<script>
/**
 * ØªØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ Ø¨Ø±Ø§ÛŒ Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ Ùˆ ØªØ¨Ø¯ÛŒÙ„ Ø±Ø´ØªÙ‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø¯Ù‡ Ø¨Ù‡ Ø¹Ø¯Ø¯.
 */
function cleanAndParse(value) {
    if (typeof value !== 'string') return 0;

    let cleaned = value.replace(/[$,%]/g, '').trim(); 
    const isNegative = value.includes('-');

    let multiplier = 1;
    // Ù…Ø¯ÛŒØ±ÛŒØª M, B, T
    if (cleaned.endsWith('T')) { multiplier = 1e12; cleaned = cleaned.slice(0, -1).trim(); }
    else if (cleaned.endsWith('B')) { multiplier = 1e9; cleaned = cleaned.slice(0, -1).trim(); }
    else if (cleaned.endsWith('M')) { multiplier = 1e6; cleaned = cleaned.slice(0, -1).trim(); }

    cleaned = cleaned.replace(/\+/g, '');
    
    let number = parseFloat(cleaned);
    
    if (isNaN(number)) return 0;

    // Ø§ÛŒÙ† ØªØ§Ø¨Ø¹ Ø¹Ø¯Ø¯ Ù†Ù‡Ø§ÛŒÛŒ Ø±Ø§ Ø¨Ù‡ Ø´Ú©Ù„ "ÙˆØ§Ø­Ø¯ Ù¾Ø§ÛŒÙ‡" (Ù…Ø«Ù„Ø§Ù‹ Ø¯Ù„Ø§Ø± ÛŒØ§ Ù…Ù‚Ø¯Ø§Ø± Ø®Ø§Ù…) Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø§Ù†Ø¯.
    return isNegative && number > 0 ? -number * multiplier : number * multiplier;
}

/**
 * ØªØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ Ø¨Ø±Ø§ÛŒ ÙØ±Ù…Øª Ø¯Ø§Ø¯Ù† Ø¨Ù‡ Ø§Ø¹Ø¯Ø§Ø¯ Ø¨Ø§ Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ.
 */
function formatValue(value, unit = '', precision = 2) {
    const num = typeof value === 'number' && !isNaN(value) ? value : cleanAndParse(value);
    
    let colorClass = 'blue';

    if (unit === '%') {
        colorClass = num > 0 ? 'green' : (num < 0 ? 'red' : 'yellow');
    } else if (unit === 'LS') {
        colorClass = num > 1.05 ? 'green' : (num < 0.95 ? 'red' : 'yellow');
        precision = 3;
    } else if (unit === 'FR') {
        colorClass = num > 0.003 ? 'green' : (num < -0.003 ? 'red' : 'yellow');
        precision = 5;
        unit = '%';
    } else if (unit.includes('M$')) {
        precision = 4;
    } else if (unit === 'RSI') {
        colorClass = num > 65 ? 'red' : (num < 35 ? 'green' : 'yellow'); 
    }

    const formattedNum = num.toFixed(precision);
    return `<td class="${colorClass}">${formattedNum}${unit}</td>`;
}

/**
 * ØªØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ Ø¨Ø±Ø§ÛŒ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…Ø­ØªÙˆØ§ÛŒ Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø¯Ù‡ Ø¯Ø± tbody.
 */
function updateTBody(tbodyId, dataHtmlArray) {
    const tbody = document.getElementById(tbodyId);
    if (!tbody) return;

    const rows = tbody.getElementsByTagName('tr');
    dataHtmlArray.forEach((dataHtml, index) => {
        if (rows[index]) {
            const dataCell = rows[index].getElementsByTagName('td')[0];
            if (dataCell) {
                dataCell.outerHTML = dataHtml; 
            }
        }
    });
}

/**
 * ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø³Ø§Ø®ØªØ§Ø±Ø¯Ù‡ÛŒ Ø«Ø§Ø¨Øª Ø¬Ø¯Ø§ÙˆÙ„ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø¹Ù†Ø§ÙˆÛŒÙ† Ø¬Ø¯ÛŒØ¯.
 */
function initializeTables() {
    // --- Û±. Ø¬Ø¯ÙˆÙ„ Ù‚ÛŒÙ…ØªØŒ ØªØºÛŒÛŒØ±Ø§ØªØŒ RSIØŒ Ø­Ø¬Ù… Ùˆ Ù…Ø§Ø±Ú©Øª Ú©Ù¾ ---
    // ØªØ±Ú©ÛŒØ¨ Ø³Ø±ÙØµÙ„â€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù‚ÛŒÙ…Øª Ùˆ Ø­Ø¬Ù… Ø¯Ø± Ø¬Ø¯ÙˆÙ„ Ø§ÙˆÙ„ Ø·Ø¨Ù‚ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¬Ø¯ÛŒØ¯
    const priceHeaders = [
        'Symbol', 
        'Price', 
        'Price Change (4h)', 
        'Price Change (24h)', 
        'Price Change(7d)',
        'RSI(4 hour)',
        'RSI(1 day)',
        'Volume (24h)', // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
        'Volume Change (24h)', // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
        'Market Cap' // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
    ];
    let priceHtml = '';
    priceHeaders.forEach(header => {
        priceHtml += `<tr><th>${header}</th><td class="data-placeholder">---</td></tr>`;
    });
    document.getElementById('price-table-body').innerHTML = priceHtml;

    // --- Û². Ø¬Ø¯ÙˆÙ„ Open Interest Ùˆ Funding Rate ---
    // Ø­Ø°Ù Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ Volume Ø§Ø² Ø§ÛŒÙ† Ø¬Ø¯ÙˆÙ„
    const oiHeaders = [
        'Funding Rate', // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
        'OI', 
        'OI Change (4h)', 
        'OI Change (24h)',
        'OI/24h_Vol',
        'OI/24h_Vol (24h%)' 
    ];
    let oiHtml = '';
    oiHeaders.forEach(header => {
        oiHtml += `<tr><th>${header}</th><td class="data-placeholder">---</td></tr>`;
    });
    document.getElementById('oi-table-body').innerHTML = oiHtml;

    // --- Û³. Ø¬Ø¯ÙˆÙ„ Ù„ÛŒÚ©ÙˆØ¦ÛŒØ¯ÛŒØ´Ù†â€ŒÙ‡Ø§ ---
    const liquidationHeaders = [
        'Liquidation (24h)', 
        'Long Liquidation (24h)', 
        'Short Liquidation (24h)', 
        'Long (24h) Value', // ØªØºÛŒÛŒØ± Ù†Ø§Ù… Ø¨Ø±Ø§ÛŒ ØªØ·Ø§Ø¨Ù‚ Ø¨Ø§ Ø¯Ø±Ø®ÙˆØ§Ø³Øª
        'Short (24h) Value'  // ØªØºÛŒÛŒØ± Ù†Ø§Ù… Ø¨Ø±Ø§ÛŒ ØªØ·Ø§Ø¨Ù‚ Ø¨Ø§ Ø¯Ø±Ø®ÙˆØ§Ø³Øª
    ];
    let liquidationHtml = '';
    liquidationHeaders.forEach(header => {
        liquidationHtml += `<tr><th>${header}</th><td class="data-placeholder">---</td></tr>`;
    });
    document.getElementById('liquidation-table-body').innerHTML = liquidationHtml;

    // --- Û´. Ù†Ø³Ø¨Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ù‡Ø±Ù… (L/S Ratio) ---
    // Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ±
    const ratioHeaders = [
        'Bnc L/S Ratio (Accounts)',
        'Bnc Top Trader L/S Ratio (Accounts)',
        'Bnc Top Trader L/S Ratio (Positions)'
    ];
    let ratioHtml = '';
    ratioHeaders.forEach(header => {
        ratioHtml += `<tr><th>${header}</th><td class="data-placeholder">---</td></tr>`;
    });
    document.getElementById('ratio-table-body').innerHTML = ratioHtml;
}

/**
 * Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙˆØ±ÙˆØ¯ÛŒ Ùˆ Ø®Ø±ÙˆØ¬ÛŒâ€ŒÙ‡Ø§.
 */
function clearForm() {
    document.getElementById('rawData').value = '';
    
    // Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ú©Ø§Ù…Ù„ Ù…Ø­ØªÙˆØ§ÛŒ ØªØ­Ù„ÛŒÙ„
    document.getElementById('analysis-output').innerHTML = '<h3>Ø®Ù„Ø§ØµÙ‡ ØªØ­Ù„ÛŒÙ„</h3><p class="error" id="error-message" style="display: none;">Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§. Ù„Ø·ÙØ§ Ù…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ **Û²Û¶ Ø³ØªÙˆÙ†** Ø±Ø§ Ø§Ø² **Ù†Ù…Ø§Ø¯ Ú©ÙˆÛŒÙ†** (Symbol) Ø¨Ù‡ Ø¨Ø¹Ø¯ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯. (ØªØ¹Ø¯Ø§Ø¯ Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ: <span id="col-count">0</span>)</p><p id="output-oi"></p><p id="output-open-positions"></p><p id="output-liquidation"></p><p id="output-funding"></p><p id="output-rsi"></p><p id="output-conclusion"></p>';
    
    // Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ù…Ø­ØªÙˆØ§ÛŒ Ø¬Ø¯ÙˆÙ„ Ø¨Ù‡ Ø­Ø§Ù„Øª Ø§ÙˆÙ„ÛŒÙ‡ (---)
    initializeTables();
    
    // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ø¨Ø®Ø´ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
    document.getElementById('data-display-section').style.display = 'none';
    document.getElementById('col-count').textContent = '0';
}

/**
 * ØªØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§.
 */
function analyzeData() {
    // 1. Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ Ø®Ø±ÙˆØ¬ÛŒ Ùˆ Ù¾ÛŒØ§Ù… Ø®Ø·Ø§
    document.getElementById('analysis-output').innerHTML = '<h3>Ø®Ù„Ø§ØµÙ‡ ØªØ­Ù„ÛŒÙ„</h3><p class="error" id="error-message" style="display: none;">Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§. Ù„Ø·ÙØ§ Ù…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ **Û²Û¶ Ø³ØªÙˆÙ†** Ø±Ø§ Ø§Ø² **Ù†Ù…Ø§Ø¯ Ú©ÙˆÛŒÙ†** (Symbol) Ø¨Ù‡ Ø¨Ø¹Ø¯ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯. (ØªØ¹Ø¯Ø§Ø¯ Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ: <span id="col-count">0</span>)</p><p id="output-oi"></p><p id="output-open-positions"></p><p id="output-liquidation"></p><p id="output-funding"></p><p id="output-rsi"></p><p id="output-conclusion"></p>';
    document.getElementById('data-display-section').style.display = 'none';
    
    const rawData = document.getElementById('rawData').value.trim();
    const dataArray = rawData.split(/\s+/).filter(n => n); 
    
    const colCountElement = document.getElementById('col-count');
    if (colCountElement) {
        colCountElement.textContent = dataArray.length;
    }

    const requiredColumns = 26;
    if (dataArray.length < requiredColumns) {
        const errorMessageElement = document.getElementById('error-message');
        if (errorMessageElement) {
             errorMessageElement.style.display = 'block';
        }
        return; 
    }

    let startIndex = Math.max(0, dataArray.length - requiredColumns);

    try {
        // --- Û². Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ùˆ Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ (Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø¨Ø§ÛŒØ¯ Ø«Ø§Ø¨Øª Ø¨Ù…Ø§Ù†Ø¯ Ú†ÙˆÙ† Ø¨Ù‡ Ø³Ø§Ø®ØªØ§Ø± ÙˆØ±ÙˆØ¯ÛŒ ÙˆØ§Ø¨Ø³ØªÙ‡ Ø§Ø³Øª) ---
        
        // **Ù‚ÛŒÙ…Øª Ùˆ RSI (Ø³ØªÙˆÙ† Û° ØªØ§ Û¶)**
        const symbol = dataArray[startIndex + 0];             
        const price = dataArray[startIndex + 1];              
        const priceChange4h = cleanAndParse(dataArray[startIndex + 2]);
        const priceChange24h = cleanAndParse(dataArray[startIndex + 3]);
        const priceChange7d = cleanAndParse(dataArray[startIndex + 4]);
        const rsi4h = cleanAndParse(dataArray[startIndex + 5]);        
        const rsi1d = cleanAndParse(dataArray[startIndex + 6]);        
        
        // **Ø­Ø¬Ù…ØŒ Ù…Ø§Ø±Ú©Øª Ú©Ù¾ Ùˆ OI (Ø³ØªÙˆÙ† Û· ØªØ§ Û±Û³)**
        const volume24h = dataArray[startIndex + 7];          
        const volumeChange24h = cleanAndParse(dataArray[startIndex + 8]);
        const marketCap = dataArray[startIndex + 9];          
        const fundingRate = cleanAndParse(dataArray[startIndex + 10]);
        const oi = dataArray[startIndex + 11];                
        const oiChange4h = cleanAndParse(dataArray[startIndex + 12]); 
        const oiChange24h = cleanAndParse(dataArray[startIndex + 13]);
        
        // **Ù†Ø³Ø¨Øª OI Ùˆ Ù„ÛŒÚ©ÙˆØ¦ÛŒØ¯ÛŒØ´Ù† (Ø³ØªÙˆÙ† Û±Û´ ØªØ§ Û±Û¸)**
        const oiVolRatio = dataArray[startIndex + 14];        
        const oiVolChange = cleanAndParse(dataArray[startIndex + 15]);
        const liquidation24h = cleanAndParse(dataArray[startIndex + 16]);
        const longLiquid = cleanAndParse(dataArray[startIndex + 17]); 
        const shortLiquid = cleanAndParse(dataArray[startIndex + 18]);
        
        // ğŸŒŸ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªÙÚ©ÛŒÚ© Ø´Ø¯Ù‡ Ù„Ø§Ù†Ú¯/Ø´ÙˆØ±Øª (Ø³ØªÙˆÙ† Û±Û¹ ØªØ§ Û²Û²) ğŸŒŸ
        const longValue = dataArray[startIndex + 19];            
        const longPercent = cleanAndParse(dataArray[startIndex + 20]);
        const shortValue = dataArray[startIndex + 21];           
        const shortPercent = cleanAndParse(dataArray[startIndex + 22]);

        // **Ù†Ø³Ø¨Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ù‡Ø±Ù… (Ø³ØªÙˆÙ† Û²Û³ ØªØ§ Û²Ûµ)**
        const binanceLSAcc = cleanAndParse(dataArray[startIndex + 23]); 
        const topTraderLSAcc = cleanAndParse(dataArray[startIndex + 24]);
        const topTraderLS = cleanAndParse(dataArray[startIndex + 25]);


        // --- Û³. Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…Ø­ØªÙˆØ§ÛŒ Ø¬Ø¯Ø§ÙˆÙ„ Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ±ØªÛŒØ¨ Ø¬Ø¯ÛŒØ¯ ---
        
        // Û±. Ø¬Ø¯ÙˆÙ„ Ù‚ÛŒÙ…ØªØŒ ØªØºÛŒÛŒØ±Ø§ØªØŒ RSIØŒ Ø­Ø¬Ù… Ùˆ Ù…Ø§Ø±Ú©Øª Ú©Ù¾
        const priceData = [
            `<td class="blue">${symbol}</td>`,
            `<td class="blue">${price}</td>`,
            formatValue(priceChange4h, '%'),
            formatValue(priceChange24h, '%'),
            formatValue(priceChange7d, '%'),
            formatValue(rsi4h, 'RSI'),
            formatValue(rsi1d, 'RSI'),
            `<td class="blue">${volume24h}</td>`,
            formatValue(volumeChange24h, '%'),
            `<td class="blue">${marketCap}</td>`
        ];
        updateTBody('price-table-body', priceData);

        // Û². Ø¬Ø¯ÙˆÙ„ Open Interest Ùˆ Funding Rate
        const oiData = [
            formatValue(fundingRate, 'FR'),
            `<td class="blue">${oi}</td>`,
            formatValue(oiChange4h, '%'),
            formatValue(oiChange24h, '%'),
            `<td class="yellow">${oiVolRatio}</td>`,
            formatValue(oiVolChange, '%')
        ];
        updateTBody('oi-table-body', oiData);

        // Û³. Ø¬Ø¯ÙˆÙ„ Ù„ÛŒÚ©ÙˆØ¦ÛŒØ¯ÛŒØ´Ù†â€ŒÙ‡Ø§
        const liquidationData = [
            formatValue(liquidation24h / 1e6, 'M$'), 
            formatValue(longLiquid / 1e6, 'M$'), 
            formatValue(shortLiquid / 1e6, 'M$'), 
            `<td class="blue">${longValue} (${longPercent.toFixed(2)}%)</td>`, // ØªØ±Ú©ÛŒØ¨ Ù…Ù‚Ø¯Ø§Ø± Ùˆ Ø¯Ø±ØµØ¯
            `<td class="blue">${shortValue} (${shortPercent.toFixed(2)}%)</td>` // ØªØ±Ú©ÛŒØ¨ Ù…Ù‚Ø¯Ø§Ø± Ùˆ Ø¯Ø±ØµØ¯
        ];
        updateTBody('liquidation-table-body', liquidationData);

        // Û´. Ù†Ø³Ø¨Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ù‡Ø±Ù… (L/S Ratio)
        const ratioData = [
            formatValue(binanceLSAcc, 'LS', 3),
            formatValue(topTraderLSAcc, 'LS', 3),
            formatValue(topTraderLS, 'LS', 3)
        ];
        updateTBody('ratio-table-body', ratioData);

        document.getElementById('data-display-section').style.display = 'block';

        // --- Û´. Ù…Ù†Ø·Ù‚ ØªØ­Ù„ÛŒÙ„ Ùˆ Ø§Ù…ØªÛŒØ§Ø²Ø¯Ù‡ÛŒ (Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø«Ø§Ø¨Øª Ù…ÛŒâ€ŒÙ…Ø§Ù†Ø¯) ---
        
        let oiAnalysis = '';
        let openPositionsAnalysis = ''; 
        let liquidationAnalysis = '';
        let fundingAnalysis = '';
        let rsiAnalysis = '';
        let finalSentimentText = '';
        let overallSentiment = 0; 
        
        // Û±. ØªØ­Ù„ÛŒÙ„ Open Interest (OI)
        if (oiChange24h > 5 && priceChange24h > 0) {
            oiAnalysis = `<li>**Ø±ÙˆÙ†Ø¯ ØµØ¹ÙˆØ¯ÛŒ Ù‚ÙˆÛŒ:** Ø§ÙØ²Ø§ÛŒØ´ Ù‚ÛŒÙ…Øª (+${priceChange24h.toFixed(2)}%) Ù‡Ù…Ø±Ø§Ù‡ Ø¨Ø§ Ø§ÙØ²Ø§ÛŒØ´ OI (+${oiChange24h.toFixed(2)}%) Ù†Ø´Ø§Ù†â€ŒØ¯Ù‡Ù†Ø¯Ù‡ **ÙˆØ±ÙˆØ¯ Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø¬Ø¯ÛŒØ¯** Ø§Ø³Øª.</li>`;
            overallSentiment += 1.0;
        } else if (oiChange24h < -5 && priceChange24h < 0) {
            oiAnalysis = `<li>**Ø±ÙˆÙ†Ø¯ Ù†Ø²ÙˆÙ„ÛŒ Ù‚ÙˆÛŒ:** Ú©Ø§Ù‡Ø´ Ù‚ÛŒÙ…Øª (${priceChange24h.toFixed(2)}%) Ù‡Ù…Ø±Ø§Ù‡ Ø¨Ø§ Ú©Ø§Ù‡Ø´ OI (${oiChange24h.toFixed(2)}%) Ù†Ø´Ø§Ù†â€ŒØ¯Ù‡Ù†Ø¯Ù‡ **Ø¨Ø³ØªÙ† Ù¾ÙˆØ²ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ Ù„Ø§Ù†Ú¯ Ø¯Ø± Ø¶Ø±Ø±** Ø§Ø³Øª.</li>`;
            overallSentiment -= 0.7;
        } else if (oiChange24h > 5 && priceChange24h < 0) {
            oiAnalysis = `<li>**Ø§ÙØ²Ø§ÛŒØ´ Ø´ÙˆØ±Øªâ€ŒÚ¯ÛŒØ±ÛŒ:** Ø§ÙØ²Ø§ÛŒØ´ OI Ù‡Ù…Ø±Ø§Ù‡ Ø¨Ø§ Ú©Ø§Ù‡Ø´ Ù‚ÛŒÙ…Øª Ù†Ø´Ø§Ù†â€ŒØ¯Ù‡Ù†Ø¯Ù‡ **Ø§ÙØ²Ø§ÛŒØ´ ÙØ´Ø§Ø± ÙØ±ÙˆØ´ (Ø´ÙˆØ±Øªâ€ŒÚ¯ÛŒØ±ÛŒ) Ùˆ Ø§Ø­ØªÙ…Ø§Ù„ Long Squeeze** Ø§Ø³Øª.</li>`;
            overallSentiment -= 1.0;
        } else if (oiChange24h < -5 && priceChange24h > 0) {
            oiAnalysis = `<li>**ØµØ¹ÙˆØ¯ Ø¶Ø¹ÛŒÙ (Short Covering):** ØµØ¹ÙˆØ¯ Ù‚ÛŒÙ…Øª Ù‡Ù…Ø±Ø§Ù‡ Ø¨Ø§ Ú©Ø§Ù‡Ø´ OI Ù†Ø´Ø§Ù†â€ŒØ¯Ù‡Ù†Ø¯Ù‡ **Ø¨Ø³ØªÙ† Ù¾ÙˆØ²ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ Ø´ÙˆØ±Øª** Ùˆ Ø¶Ø¹Ù Ù†Ø³Ø¨ÛŒ Ø¯Ø± Ø§Ø¯Ø§Ù…Ù‡â€ŒÛŒ Ø±ÙˆÙ†Ø¯ Ø§Ø³Øª.</li>`;
            overallSentiment += 0.3;
        } else {
             oiAnalysis = `<li>**Ø¹Ø¯Ù… Ù‚Ø·Ø¹ÛŒØª/ØªØ«Ø¨ÛŒØª:** Ø§Ù„Ú¯ÙˆÛŒ OI Ùˆ Ù‚ÛŒÙ…Øª Ø¯Ø± Û²Û´ Ø³Ø§Ø¹Øª Ú¯Ø°Ø´ØªÙ‡ Ø´Ø¯ÛŒØ¯ Ù†ÛŒØ³Øª.</li>`;
        }

        // Û². ØªØ­Ù„ÛŒÙ„ Ù¾ÙˆØ²ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø² Ù„Ø§Ù†Ú¯/Ø´ÙˆØ±Øª Û²Û´ Ø³Ø§Ø¹ØªÙ‡ 
        const percentDifference = shortPercent - longPercent; 

        if (percentDifference > 3) { 
            openPositionsAnalysis = `<li>**ØºÙ„Ø¨Ù‡ Ù‚ÙˆÛŒ Ø´ÙˆØ±Øª:** (${shortPercent.toFixed(2)}% Ø´ÙˆØ±Øª Ø¯Ø± Ù…Ù‚Ø§Ø¨Ù„ ${longPercent.toFixed(2)}% Ù„Ø§Ù†Ú¯). Ø­Ø¬Ù… Ø¨Ø§Ù„Ø§ÛŒ Ø´ÙˆØ±Øª Ù†Ø´Ø§Ù†â€ŒØ¯Ù‡Ù†Ø¯Ù‡ **Ø±ÛŒØ³Ú© Ø¨Ø§Ù„Ø§ Ø¨Ø±Ø§ÛŒ Short Squeeze** (ÙØ´Ø±Ø¯Ú¯ÛŒ Ø´ÙˆØ±Øª) Ø¯Ø± ØµÙˆØ±Øª ØµØ¹ÙˆØ¯ Ù†Ø§Ú¯Ù‡Ø§Ù†ÛŒ Ø§Ø³Øª.</li>`;
            overallSentiment -= 0.3; 
        } else if (percentDifference < -3) { 
            openPositionsAnalysis = `<li>**ØºÙ„Ø¨Ù‡ Ù‚ÙˆÛŒ Ù„Ø§Ù†Ú¯:** (${longPercent.toFixed(2)}% Ù„Ø§Ù†Ú¯ Ø¯Ø± Ù…Ù‚Ø§Ø¨Ù„ ${shortPercent.toFixed(2)}% Ø´ÙˆØ±Øª). Ø­Ø¬Ù… Ø¨Ø§Ù„Ø§ÛŒ Ù„Ø§Ù†Ú¯ Ù†Ø´Ø§Ù†â€ŒØ¯Ù‡Ù†Ø¯Ù‡ **Ø±ÛŒØ³Ú© Ø¨Ø§Ù„Ø§ Ø¨Ø±Ø§ÛŒ Long Squeeze** (ÙØ´Ø±Ø¯Ú¯ÛŒ Ù„Ø§Ù†Ú¯) Ø¯Ø± ØµÙˆØ±Øª Ù†Ø²ÙˆÙ„ Ù†Ø§Ú¯Ù‡Ø§Ù†ÛŒ Ø§Ø³Øª.</li>`;
            overallSentiment -= 0.3; 
        } else {
            openPositionsAnalysis = `<li>**ØªØ¹Ø§Ø¯Ù„ Ø¯Ø± Ù¾ÙˆØ²ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²:** Ù„Ø§Ù†Ú¯ Ùˆ Ø´ÙˆØ±Øª Ø¬Ø¯ÛŒØ¯ Ù†Ø³Ø¨ØªØ§Ù‹ Ù…ØªØ¹Ø§Ø¯Ù„ Ù‡Ø³ØªÙ†Ø¯.</li>`;
        }
        
        // Û³. ØªØ­Ù„ÛŒÙ„ Ù„ÛŒÚ©ÙˆØ¦ÛŒØ¯ÛŒØ´Ù† Ùˆ L/S Ratio
        const liquidDifference = (shortLiquid - longLiquid) / 1e6; 
        const shortLiquidM = shortLiquid / 1e6;
        const longLiquidM = longLiquid / 1e6;
        
        if (liquidDifference > 10) { 
            liquidationAnalysis = `<li>**ØºÙ„Ø¨Ù‡ Ù„ÛŒÚ©ÙˆØ¦ÛŒØ¯ Ø´ÙˆØ±Øª:** ${shortLiquidM.toFixed(2)}M$ Ø´ÙˆØ±Øª Ù„ÛŒÚ©ÙˆØ¦ÛŒØ¯ Ø´Ø¯ (Ø¨ÛŒØ´ Ø§Ø² Û±Û°M$ Ø§Ø®ØªÙ„Ø§Ù). Ø§ÛŒÙ† **ÙØ´Ø§Ø± ØµØ¹ÙˆØ¯ÛŒ** Ø±Ø§ ØªØ£ÛŒÛŒØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.</li>`;
            overallSentiment += 0.5;
        } else if (liquidDifference < -10) {
            liquidationAnalysis = `<li>**ØºÙ„Ø¨Ù‡ Ù„ÛŒÚ©ÙˆØ¦ÛŒØ¯ Ù„Ø§Ù†Ú¯:** ${longLiquidM.toFixed(2)}M$ Ù„Ø§Ù†Ú¯ Ù„ÛŒÚ©ÙˆØ¦ÛŒØ¯ Ø´Ø¯ (Ø¨ÛŒØ´ Ø§Ø² Û±Û°M$ Ø§Ø®ØªÙ„Ø§Ù). Ø§ÛŒÙ† **ÙØ´Ø§Ø± Ù†Ø²ÙˆÙ„ÛŒ** Ø±Ø§ ØªØ£ÛŒÛŒØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.</li>`;
            overallSentiment -= 0.5;
        } else {
            liquidationAnalysis = `<li>**ØªØ¹Ø§Ø¯Ù„ Ø¯Ø± Ù„ÛŒÚ©ÙˆØ¦ÛŒØ¯ÛŒØ´Ù†:** Ù„ÛŒÚ©ÙˆØ¦ÛŒØ¯ÛŒØ´Ù† Ù„Ø§Ù†Ú¯ Ùˆ Ø´ÙˆØ±Øª Ù†Ø³Ø¨ØªØ§Ù‹ Ø¨Ø±Ø§Ø¨Ø± Ø§Ø³Øª.</li>`;
        }

        if (topTraderLS > 1.25) {
            liquidationAnalysis += `<li>**Ø³Ù†ØªÛŒÙ…Ù†Øª Ù‚ÙˆÛŒ Ù„Ø§Ù†Ú¯â€ŒÚ¯ÛŒØ±Ø§Ù† Ø¨Ø±ØªØ±:** Ù†Ø³Ø¨Øª L/S Ù¾ÙˆØ²ÛŒØ´Ù† ØªØ±ÛŒØ¯Ø±Ù‡Ø§ÛŒ Ø¨Ø±ØªØ± (${topTraderLS.toFixed(2)}) **Ø¨Ù‡ Ø´Ø¯Øª ØµØ¹ÙˆØ¯ÛŒ** Ø§Ø³Øª.</li>`;
            overallSentiment += 1;
        } else if (topTraderLS < 0.75) {
            liquidationAnalysis += `<li>**Ø³Ù†ØªÛŒÙ…Ù†Øª Ù‚ÙˆÛŒ Ø´ÙˆØ±Øªâ€ŒÚ¯ÛŒØ±Ø§Ù† Ø¨Ø±ØªØ±:** Ù†Ø³Ø¨Øª L/S Ù¾ÙˆØ²ÛŒØ´Ù† ØªØ±ÛŒØ¯Ø±Ù‡Ø§ÛŒ Ø¨Ø±ØªØ± (${topTraderLS.toFixed(2)}) **Ø¨Ù‡ Ø´Ø¯Øª Ù†Ø²ÙˆÙ„ÛŒ** Ø§Ø³Øª.</li>`;
            overallSentiment -= 1;
        } else {
            liquidationAnalysis += `<li>**Ø³Ù†ØªÛŒÙ…Ù†Øª Ø®Ù†Ø«ÛŒ ØªØ±ÛŒØ¯Ø±Ù‡Ø§ÛŒ Ø¨Ø±ØªØ±:** Ù†Ø³Ø¨Øª L/S Ù¾ÙˆØ²ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ Ø¨Ø±ØªØ± (${topTraderLS.toFixed(2)}) Ø®Ù†Ø«ÛŒ Ø§Ø³Øª.</li>`;
        }
        
        // Û´. ØªØ­Ù„ÛŒÙ„ Funding Rate
        if (fundingRate > 0.005) {
            fundingAnalysis = `<li>**ÙØ§Ù†Ø¯ÛŒÙ†Ú¯ Ø±ÛŒØª Ø¨Ø§Ù„Ø§ Ùˆ Ù…Ø«Ø¨Øª (${fundingRate.toFixed(4)}%):** Ù†Ø´Ø§Ù†â€ŒØ¯Ù‡Ù†Ø¯Ù‡ **Ø§Ø­Ø³Ø§Ø³Ø§Øª ØµØ¹ÙˆØ¯ÛŒ Ø§ÙØ±Ø§Ø·ÛŒ (Long Crowding)** Ø§Ø³Øª.</li>`;
            overallSentiment += 0.5;
        } else if (fundingRate < -0.005) {
            fundingAnalysis = `<li>**ÙØ§Ù†Ø¯ÛŒÙ†Ú¯ Ø±ÛŒØª Ù…Ù†ÙÛŒ (${fundingRate.toFixed(4)}%):** Ù†Ø´Ø§Ù†â€ŒØ¯Ù‡Ù†Ø¯Ù‡ **Ø§Ø­Ø³Ø§Ø³Ø§Øª Ù†Ø²ÙˆÙ„ÛŒ Ø´Ø¯ÛŒØ¯** Ø§Ø³Øª.</li>`;
            overallSentiment -= 0.5;
        } else {
            fundingAnalysis = `<li>**ÙØ§Ù†Ø¯ÛŒÙ†Ú¯ Ø±ÛŒØª Ø®Ù†Ø«ÛŒ (${fundingRate.toFixed(4)}%):** ÙØ´Ø§Ø± Ø´Ø¯ÛŒØ¯ÛŒ Ø¯ÛŒØ¯Ù‡ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯.</li>`;
        }

        // Ûµ. ØªØ­Ù„ÛŒÙ„ RSI
        let rsiClass = 'sentiment-neutral';
        let rsiToAnalyze = rsi4h; 

        if (rsiToAnalyze < 35) {
            rsiAnalysis = `<li>**Ø§Ø´Ø¨Ø§Ø¹ ÙØ±ÙˆØ´ (RSI 4h: ${rsiToAnalyze.toFixed(2)}):** Ø³ÛŒÚ¯Ù†Ø§Ù„ Ø¨Ø§Ù„Ù‚ÙˆÙ‡ Ø¨Ø±Ø§ÛŒ **Ø¨Ø§Ø²Ú¯Ø´Øª ØµØ¹ÙˆØ¯ÛŒ (Reversal)** Ø§Ø³Øª.</li>`;
            rsiClass = 'sentiment-bullish'; 
            overallSentiment += 0.3;
        } else if (rsiToAnalyze > 65) {
            rsiAnalysis = `<li>**Ø§Ø´Ø¨Ø§Ø¹ Ø®Ø±ÛŒØ¯ (RSI 4h: ${rsiToAnalyze.toFixed(2)}):** Ø³ÛŒÚ¯Ù†Ø§Ù„ Ø¨Ø§Ù„Ù‚ÙˆÙ‡ Ø¨Ø±Ø§ÛŒ **Ø§ØµÙ„Ø§Ø­ ÛŒØ§ Ú©Ø§Ù‡Ø´ Ù‚ÛŒÙ…Øª** Ø§Ø³Øª.</li>`;
            rsiClass = 'sentiment-bearish'; 
            overallSentiment -= 0.3;
        } else {
            rsiAnalysis = `<li>**Ø®Ù†Ø«ÛŒ (RSI 4h: ${rsiToAnalyze.toFixed(2)}):** RSI Ø¯Ø± Ù…Ù†Ø·Ù‚Ù‡ Ø®Ù†Ø«ÛŒ Ù‚Ø±Ø§Ø± Ø¯Ø§Ø±Ø¯.</li>`;
        }

        // Û¶. Ù†ØªÛŒØ¬Ù‡ Ú¯ÛŒØ±ÛŒ Ú©Ù„ÛŒ
        let conclusionClass = '';
        
        if (overallSentiment > 1.8) {
            finalSentimentText = 'Ø§Ø­Ø³Ø§Ø³Ø§Øª Ú©Ù„ÛŒ Ø¨Ø§Ø²Ø§Ø± **Ø¨Ø³ÛŒØ§Ø± ØµØ¹ÙˆØ¯ÛŒ Ùˆ Ø¨Ø§ Ø±ÛŒØ³Ú© Ø¹Ù‚Ø¨â€ŒÙ†Ø´ÛŒÙ†ÛŒ Ø¨Ø§Ù„Ø§** Ø§Ø³Øª. Ø¨Ø§ÛŒØ¯ Ù…Ø­ØªØ§Ø· Ø¨ÙˆØ¯.';
            conclusionClass = 'sentiment-bullish';
        } else if (overallSentiment > 0.7) {
            finalSentimentText = 'Ø§Ø­Ø³Ø§Ø³Ø§Øª Ú©Ù„ÛŒ **ØµØ¹ÙˆØ¯ÛŒ** Ø§Ø³Øª. Ø¨Ø§Ø²Ø§Ø± Ù…Ø§ÛŒÙ„ Ø¨Ù‡ Ø§Ø¯Ø§Ù…Ù‡ Ø±Ø´Ø¯ Ø§Ø³Øª.';
            conclusionClass = 'sentiment-bullish';
        } else if (overallSentiment < -0.7) {
            finalSentimentText = 'Ø§Ø­Ø³Ø§Ø³Ø§Øª Ú©Ù„ÛŒ **Ù†Ø²ÙˆÙ„ÛŒ** Ø§Ø³Øª. Ù‚Ø¯Ø±Øª Ø´ÙˆØ±Øªâ€ŒÚ¯ÛŒØ±Ø§Ù† Ø¨Ø§Ù„Ø§ Ø§Ø³Øª Ùˆ Ø§Ø­ØªÙ…Ø§Ù„ Ú©Ø§Ù‡Ø´ Ù‚ÛŒÙ…Øª ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯.';
            conclusionClass = 'sentiment-bearish';
        } else {
            finalSentimentText = 'Ø§Ø­Ø³Ø§Ø³Ø§Øª Ú©Ù„ÛŒ **Ø®Ù†Ø«ÛŒ/Ù†Ø§Ù…Ø´Ø®Øµ** Ø§Ø³Øª. Ø¨Ù‡ØªØ± Ø§Ø³Øª Ù…Ù†ØªØ¸Ø± ØªØ£ÛŒÛŒØ¯ Ø¨Ù…Ø§Ù†ÛŒØ¯.';
            conclusionClass = 'sentiment-neutral';
        }


        // --- Ûµ. Ù†Ù…Ø§ÛŒØ´ Ø®Ø±ÙˆØ¬ÛŒ ØªØ­Ù„ÛŒÙ„ ---
        document.getElementById('output-oi').innerHTML = `
            <h3 class="sentiment-neutral">Û±. ØªØ­Ù„ÛŒÙ„ Open Interest ,FundingRate 
:</h3>
            <ul>${oiAnalysis}</ul>
        `;
        
        document.getElementById('output-open-positions').innerHTML = `
            <h3 class="sentiment-neutral">Û². ØªØ­Ù„ÛŒÙ„ Ù¾ÙˆØ²ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø² Û²Û´ Ø³Ø§Ø¹ØªÙ‡:</h3>
            <ul>${openPositionsAnalysis}</ul>
        `;

        document.getElementById('output-liquidation').innerHTML = `
            <h3 class="sentiment-neutral">Û³. ØªØ­Ù„ÛŒÙ„ Ù„ÛŒÚ©ÙˆØ¦ÛŒØ¯ÛŒØ´Ù† Ùˆ ØªØ±ÛŒØ¯Ø±Ù‡Ø§ÛŒ Ø¨Ø±ØªØ±:</h3>
            <ul>${liquidationAnalysis}</ul>
        `;

        document.getElementById('output-funding').innerHTML = `
            <h3 class="sentiment-neutral">Û´. ØªØ­Ù„ÛŒÙ„ Funding Rate:</h3>
            <ul>${fundingAnalysis}</ul>
        `;
        
        document.getElementById('output-rsi').innerHTML = `
            <h3 class="sentiment-neutral">Ûµ. ØªØ­Ù„ÛŒÙ„ Ø´Ø§Ø®Øµ RSI:</h3>
            <ul class="${rsiClass}">${rsiAnalysis}</ul>
        `;
        
        document.getElementById('output-conclusion').innerHTML = `
            <h3 class="sentiment-neutral">Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ Ú©Ù„ÛŒ Ø¨Ø±Ø§ÛŒ ${symbol}:</h3>
            <p class="${conclusionClass}" style="font-size: 1.2em; font-weight: bold;">${finalSentimentText}</p>
        `;

    } catch (e) {
        // Ø¯Ø± ØµÙˆØ±Øª Ø¨Ø±ÙˆØ² Ø®Ø·Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡ØŒ Ù¾ÛŒØ§Ù… Ø®Ø·Ø§ Ø±Ø§ Ù†Ø´Ø§Ù† Ø¯Ù‡Ø¯
        document.getElementById('error-message').style.display = 'block';
        console.error("An unexpected error occurred:", e);
    }
}

// ğŸŒŸ Ø§Ø¬Ø±Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ØªØ§Ø¨Ø¹ Ø³Ø§Ø®ØªØ§Ø±Ø¯Ù‡ÛŒ Ø¯Ø± Ù‡Ù†Ú¯Ø§Ù… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØµÙØ­Ù‡
document.addEventListener('DOMContentLoaded', initializeTables);
</script>

</body>
</html>
